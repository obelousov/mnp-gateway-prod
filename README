to re-build images (eg when update requirements.txt)
docker compose -f compose.yml -f compose-rabbitmq.yml up -d --build

docker compose -f compose.yml -f compose-rabbitmq.yml up -d
docker compose -f compose.yml -f compose-rabbitmq.yml down
docker compose -f compose.yml -f compose-rabbitmq.yml restart api

curl http://localhost:8090/api/v1/health
{"status":"healthy","service":"MNP Gateway API","version":"1.0.0","timestamp":1759602021.7271955}

https://mnp-api.olbe.tech/api/v1/healthcheck

curl http://localhost:8090
{"message":"MNP Gateway Service is running"}

curl -X POST http://localhost:8090/api/v1/query-msisdn
{"status":"MSISDN Query accepted","service":"Gateway for handling MNP queries between BSS and Central Node","version":"1.0.0","timestamp":1759611472.214557}

adminer
root:root
http://localhost:8060/?server=db&username=pondphone&db=mnp_database

grafana
http://localhost:3000/login

traefik dashboard
http://localhost:8080/dashboard/
http://localhost:8080/dashboard/#/http/routers

flower:
http://localhost:5555/
admin: admin

RabitMQ UI
http://localhost:15672/#/
admin: admin123

swagger docs
https://mnp-api.olbe.tech/docs
https://mnp-api.olbe.tech/redoc
admin:secret@123

planUML
http://localhost:9090

curl -k -u "apiuser:api@password" https://mnp-api.olbe.tech/api/v1/healthcheck

to generate self-signed certifciate for testing:
openssl req -x509 -nodes -days 365 -newkey rsa:2048   -keyout traefik/certs/private.key   -out traefik/certs/certificate.crt   -subj "/C=US/ST=State/L=City/O=MNP/CN=mnp-api.olbe.tech"   -addext "subjectAltName=DNS:mnp-api.olbe.tech,DNS:localhost,IP:127.0.0.1"
  705  openssl x509 -in traefik/certs/certificate.crt -text -noout | grep -A 5 "X509v3"

with RabitMQ
docker compose -f compose.yml -f compose-rabbitmq.yml up -d --build
docker compose -f compose.yml -f compose-rabbitmq.yml up -d
docker compose -f compose.yml -f compose-rabbitmq.yml up -d --force-recreate
docker compose -f compose.yml -f compose-rabbitmq.yml down
docker compose logs -f

root@7e62fac0f3f3:/app# python -m services.soap_builder
root@b56786830fcc:/app# python -m services.time_services

docker exec -it mnp-api bash
root@b56786830fcc:/app# python -m tests.nc_qeries

to run varios tests:
docker exec mnp-api python -m tests.nc_qeries

url to submit queries from app
https://sms2email.olbe.tech/webhook_receiver
here can see body of requests sent from mnp-gateway app
https://sms2email.olbe.tech/webhook_dashboard

alembic-DB migrations commands:
1.copy alembic-migrations/alembic.ini.template to alembic-migrations/alembic.ini
2.update alembic.ini with connection string to mysql instance
sqlalchemy.url = mysql+pymysql://user:password@host:3307/database
3.alembic containers commands
docker compose -f alembic-migrations/compose.yml up -d --build
docker compose -f alembic-migrations/compose.yml up -d
docker compose -f alembic-migrations/compose.yml down
4.Run migrations:
docker compose -f alembic-migrations/compose.yml exec alembic-app alembic revision --autogenerate -m "Validate database schema"
5.validate migration script (located in alembic-migrations/versions/) and only everyhting is ok - apply migrations:
docker compose -f alembic-migrations/compose.yml exec alembic-app alembic upgrade head
6. This command will mark all migrations as applied. Eg if you do not want to apply existing migrations 
but want to start applying new ones from now on:
docker compose -f alembic-migrations/compose.yml exec alembic-app alembic stamp head

in case need to rollback last migration:
docker compose -f alembic-migrations/compose.yml exec alembic-app alembic downgrade -1

to validate sqlalchemy connectivity from inside alembic-app container:
docker compose -f alembic-migrations/compose.yml exec alembic-app python -c "
import os
DB_USER = os.getenv('DB_USER')
DB_PASSWORD = os.getenv('DB_PASSWORD') 
DB_NAME = os.getenv('DB_NAME')
print(f'mysql+pymysql://{DB_USER}:{DB_PASSWORD}@localhost:3307/{DB_NAME}')

import sqlalchemy
engine = sqlalchemy.create_engine(f'mysql+pymysql://{DB_USER}:{DB_PASSWORD}@localhost:3307/{DB_NAME}')
conn = engine.connect()
print('Connected successfully!')
conn.close()
"


